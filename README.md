# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Структура кода придерживается MVP-архитектуры.

### Базовый код.

#### Слой Model:

- Класс Api - предоставляет базовые методы для HTTP-запросов к серверу. Добавляет единую конфигурацию.
  * Поля:
      - baseUrl - базовый URL для всех запросов.
      - options - настройка fetch.

  * Методы:
     - handleResponse - обраьбатывет Response от fetch, проверяет статус и извлекает json.
     - get - выполняет GET-запрос. Формирует полный URL, передает ответы в handleResponse.
     - post - выполняет POST(или другой метод)-запрос.Формирует URL. Передает результаты в handleResponse.
---
- Класс EventEmitter - позволяет подписываться на события (on), отписываться (off) и уведомлении (emit) о наступлении события. Дополнительно реализованы методы  onAll и  offAll  — для подписки на все события и сброса всех подписчиков.
---
- Базовый абстрактный класс Component<T> - представляет общую функциональность для компонентов представления. Реализует базовые операции с DOM-элементами, типизацию свойств компонента. В зависимости от метода, позволяет получить как аргумент HTML-элемент и изменить его, скрыть или отобразить.
  
  * Поля: 
    - container - корневой HTML-элемент компонент, доступен для наследования, но не изменяем.
  
  * Методы:
   - toggleClass - переключает CSS-классы у элемента.
   - setText - устанавливает текстовое содержимое элемента.
   - setDisabled -включает/выключает элемент.
   - setHidden - скрывает элемент.
   - setVisible - делает элемент видимым.
   - setImage - устанавливает src и alt для изображний.
   - render - основной метод, обновляет состояние компонента и возвращает корневой элемент. 
---
- Класс Model<T> - абстрактный базовый класс для моделей данных. Обеспечивает инициализацию состояния, возможность эмитить события и интеграцию событий.
  
  * Метод:
    - emitChanges - уведомляет подписчиков о изменеии состояния модели
---
- Класс AppData - отвечает за хранение и управление состоянием данных: карточек товаров, корзины, заказа, контактной информации и валидации форм. Наследуется от Model. Наследует методы emitChanges - уведомляет подписчиков об изменении состояния и on - подписывает на собвтия.

  * Поля: 
    - basket - массив id товаров, добавленных в корзину;
    - cards - список карточек товаров.
    - order - объект, хранящий данные о способе оплаты и адресе доставки.
    - contacts -  объект, хранящий информациб о пользователе, его почту и телефон.  
    - FormErrorsOrder - объект с ошибками валидации формы заказа.

 * Основные методы: 
    - Работа с каталогом: addCards - добавляет товары в каталог; getCardById - находит товар по id; getCards - возвращает полный список карточек;  
    - Работа с корзиной: addToBasket - добавляет выбранный товар в корзину; removeFromBasket - удаляет выбранный товар из корзины; clearBasket - очищает корзину; getTotal - вычисляет общую стоимость товаров;
   - Работа с полями и валидацией: setOrderField - устанавливает значения полей в обьекте order; validateOrder - проверяет поля заказа на валидность; setContactsField - устанавливает значения полей в contacts; validateContacts - проверяет поля контактов на валидность; - FormErrorsContacts - объект с ошибками валидации формы контактов; - clearOrderField - очистка полей ввода способа оплаты и адреса.
---
- класс CardsApi - класс для работы с API сервера для получения каталога товаров, деталей товара и для отправки заказа. Наследуется от базового класса Api, расширяя его функциональность под конкретные задачи.

   В конструкторе принимает параметры: baseUrl - базовый URL API; cdn - базовый URL CDN для изображений; options - настройки дял fetch.

   * Методы:
   - getCatalog - получает список всех товаров из API и преобразует пути к изображениям.
   - getCardItem - получает данные одной карточки товара по id и также обновляет путь к изображению.
   - orderSend - отправляет данные заказа на сервер.
---
#### View:

- Класс CardItem - представляет собой шаблон карточки товара для отображения ее на странице и для взаимодействия с ней пользователя.
 * Поля:
   - category - элемент отображения категории товара.
	 - title - наименование товара.
	 - image - изображение товара.
	 - price - цена товара.
	 - cardId - хранит id товара.

  * Сеттеры и геттеры:
   - set id -  устанавливает id карточки и хранит в data.
   - get id - возвращает текущий id карточки.
   - set cardTitle - устанавливает наименование товара.
   - set cardImage - устанавливает изображение товара.
   - set cardCategory - устанавливает категорию товара и добавляет CSS-класс в зависимости от типа.
   - set cardPrice - устанавливает стоимость товара.

  * Метод:
   - render - обновляет всю карточку.
---
- Класс CardPreview - компонент предпросмотра карточки товара.
  * Поля:
   - button - кнопка добавления/удаления в/из корзины.
   - category - элемент отображения категории товара.
	 - title - наименование товара.
   - description - описание товара.
	 - image - изображение товара.
	 - price - цена товара.
	 - cardId - хранит id товара.
  
  * Сеттеры:
   - set button - устанавливает текст кнопки.
   - set buttonDisabled - управляет состоянием кнопки (активна/неактивна).

  * Метод:
   - render - обновляет все поля на основе данных товара.
---
- Класс Page - класс для отображения всей страницы, включающая галерею товаров, счетчик товаров в корзине, а так же отвечает за блокировку прокрутки при открытом модальном окне.
 
 * Поля:
   - counter - отображает количество товаров в корзине.
   - gallery - контейнер для карточек товаров.
   - wrapper - обертка страницы.
   - basket - кнопка корзины товаров.
  
  * Сеттеры:
   - set counter - устанавливает количество товаров в корзине на иконке.
   - set gallery - заполняет содержимое контейнера карточками товаров
   - set locked - блокирует/разблокирует прокрутку страницы.
---
- Класс CardInBasket - представляет отображение карточки товара в корзине покупок. Обеспечивает возможность удалить товар, а так же присваивает порядковый номер товару в корзине.

  * Поля:
   - index - отображает порядковый номер в списке.
   - button - кнопка удаления товара из корзины.
   - title - название товара.
   - price - цена товара.
   - cardId - хранит id текущего товара.

  * Сеттер:
   - set index - устанавливает порядковый номер товара в корзине.

  * Метод: 
   - render - обновление данных карточки товара.
---
- Класс Form<T> - базовый класс для всех форм, обеспечивает управление состоянием формы, обработку введённых данных, валидацию и отображение ошибок, а так же отправку данных.
  * Поля:
   - submit - кнопка отправления формы.
   - errors - контейнер для ошибок валидации.
  * Метод:
   - onInputChange - обработчик изменений полей ввода.
   - render - обновление состояния формы.
  * Сеттеры:
   - set valid - управление доступностью кнопки отправки.
   - set errors - текст ошибки.
---
- Класс Contact, наследуется от Form<IContacts> (позволяет использовать возможности: валидация формы; обработка сабмита; отображение ошибок; обработка изменений полей.) - реализует форму контактных данных(телефон и почта).

  * Поля:
   - button - кнопка для отправки данных пользователя на сервер.

  * Сеттеры: 
   - set phone - устанавливает значение поля телефон в форме. 
   - set email - устанавливает значение поля email в форме.
---
- Класс Order - реализует форму оформления заказа, обеспечивает выбор способа оплаты, ввода адреса доставки.Наследуется от Form<IOrder> (позволяет использовать возможности: валидация формы; обработка сабмита; отображение ошибок; обработка изменений полей.)
 
 * Поля:
    - paymentCard - кнопка выбора оплаты картой.
	  - paymentCash - кнопка выбора оплаты наличкой.
	  - address - поле ввода адреса.
	  - button - кнопка перехода к следующему окну ввода данных.

 * Сеттер:
   - set address - устанавливает значение поля адрес.
---
- Класс Modal - универсальный компонент модального окна. 
  Отвечает за:
      * Базовую функциональность модальных окон (открыть/закрыть);
      * Управление содержимым модального окна;
      * Генерацию событий при взаимодействии полььзователя с окном;
      * Интеграцию с системой событий приложения.
  
  * Поля:
   - closeButton - кнопка закрытия.
   - content - контейнер для содержимого.

  * Сеттер:
   - set content - устанавливает содержимое модального окна.

  * Методы:
   -  toggleModal - переключает состояние окна.
   - open - открытие модального окна (генерирует событие 'modal:open').
   - close - закрытие модального окна (генерирует событие'modal:close'(очищает содержимое при закрытии)).
   - render - обновляет состояние и открывает модальное окно.
---
- Класс Basket - представляет корзину покупок. Отображает список товаров, общую стоимость и кнопку для оформления покупки.

  * Поля: 
    - list - контейнер для списка товаров.
	  - total - отображение общей стоимости.
	  - button - кнопка оформления заказа(переводит к окну выбора способа оплаты и адреса доставки).

  * Сеттеры:
    - set items - устанавливает список товаров в корзине.
    - set total - устанавливает сумму заказа.

  * Метод:
    - clear - очищает корзину(удаляет все товары и сбрасывает сумму).
---
- Класс Success - компонент отображающий успешное завершение заказа. Показывает сумму списания, сдержит кнопку закрытия.
  * Поля:
  - close - элемент для закрытия модального окна.
  - total - элемент для отображения итоговой суммы списания.

  * Сеттер:
   - set total - устанавливает отображаемую сумму списания.
---